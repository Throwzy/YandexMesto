!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);class o{constructor(e){this.url=e.url,this.headers=e.headers,this.method=e.method,this.body=e.body,this.baseUrl=e.baseUrl}getInititalCards(){return fetch(this.baseUrl+"/cards",{headers:this.headers}).then(e=>e.ok?e.json():Promise.reject("Ошибка: "+e.status))}getProfile(){return fetch(this.baseUrl+"/users/me",{headers:this.headers}).then(e=>e.ok?e.json():Promise.reject("Ошибка: "+e.status))}renewProfile(e,t){return fetch(this.baseUrl+"/users/me",{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e,about:t})}).then(e=>e.ok?e.json():Promise.reject("Ошибка: "+e.status))}}class r{constructor(e,t){this.name=e,this.link=t,this.remove=this.remove.bind(this)}like(){this.classList.toggle("place-card__like-icon_liked")}remove(){this.newCard.querySelector(".place-card__like-icon").removeEventListener("click",this.like),this.newCard.querySelector(".place-card__delete-icon").removeEventListener("click",this.remove),this.newCard.remove()}create(){const e=document.createElement("div");e.insertAdjacentHTML("afterbegin",'<div class="place-card">\n        <div class="place-card__image" style="background-image: url(https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg)">\n          <button class="place-card__delete-icon"></button>\n        </div>\n        <div class="place-card__description">\n          <h3 class="place-card__name">Камчатка</h3>\n          <button class="place-card__like-icon"></button>\n        </div>\n      </div>');const t=e.firstElementChild;return t.querySelector(".place-card__name").textContent=this.name,t.querySelector(".place-card__image").style.backgroundImage=`url(${this.link})`,this.newCard=t,this.setListener(),t}setListener(){this.newCard.querySelector(".place-card__like-icon").addEventListener("click",this.like),this.newCard.querySelector(".place-card__delete-icon").addEventListener("click",this.remove)}}class s{constructor(e,t,n){this.container=e,this.createCard=t,this.api=n}addCard(e,t){const n=this.createCard(e,t);this.container.appendChild(n)}render(e){this.api=e,this.api.forEach(e=>{this.addCard(e.name,e.link)})}}class i{constructor(e){this.formV=e,this.setEventListeners=this.setEventListeners.bind(this)}checkInputValidity(e,t){return 0===e.value.length?(t.textContent="Это обязательное поле",!1):(e.value.length<2||e.value.length>30)&&"text"===e.type?(t.textContent="Должно быть от 2 до 30 символов",!1):e.validity.typeMismatch&&"url"===e.type?(t.textContent="Здесь должна быть ссылка!",!1):(t.textContent="",!0)}setSubmitButtonState(e){const t=this.formV.querySelector("button");e||(t.setAttribute("disabled",!0),t.classList.add("popup__button_invalid")),e&&(t.removeAttribute("disabled",!0),t.classList.remove("popup__button_invalid"))}setEventListeners(){const e=[...this.formV.querySelectorAll("input")];this.formV.querySelector("button");this.formV.addEventListener("input",t=>{const n=t.target,o=t.target.nextElementSibling;this.checkInputValidity(n,o),e.every(e=>e.validity.valid)?this.setSubmitButtonState(!0):this.setSubmitButtonState(!1)})}}class c{constructor(e){this.popupContainer=e}open(){this.popupContainer.classList.add("popup_is-opened")}close(){this.popupContainer.classList.remove("popup_is-opened")}}class a{constructor(e,t){this.popup=e,this.chooseImage=t}openWide(e){this.popup.classList.add("popup_is-opened"),this.chooseImage.src=""+e}}class u{constructor(e,t,n,o,r){this.elementName=e,this.elementAbout=t,this.elementNameEdit=n,this.elementAboutEdit=o,this.api=r,this.name=r.name,this.about=r.about}setUserInfo(e,t){this.elementName.textContent=e,this.elementAbout.textContent=t,this.elementNameEdit.value=e,this.elementAboutEdit.value=t}updateUserInfo(e,t){this.elementName.textContent=this.elementNameEdit.value,this.elementAbout.textContent=this.elementAboutEdit.value}}n(0);!function(){const e=document.forms.new,t=document.forms.editform,n=document.querySelector(".popup_images"),l=document.querySelector(".popup__image"),d=(document.querySelector(".place-card__image"),document.querySelector(".popup__close-picture")),p=(document.getElementsByName("username"),document.querySelector(".user-info__name")),m=document.querySelector(".user-info__job"),h=t.elements.username,_=t.elements.about,y=document.querySelector(".edit-popup"),f=(document.querySelector(".popup__save"),document.querySelector(".place-card__like-icon"),document.querySelector(".place-card"),document.querySelector(".popup"),document.querySelector(".popup_is-opened"),document.querySelector(".button"),document.querySelector(".user-edit__button")),v=document.querySelector(".user-info__button"),b=(document.querySelector(".popup__close"),document.querySelector(".popup__close-edit")),S=document.querySelector(".popup__close-place"),g=document.querySelector(".popup-place"),q=document.querySelector(".places-list");document.querySelector(".popup__content"),document.querySelector(".button"),e.querySelector(".popup__button"),document.querySelector(".popup__input_type_name"),document.querySelector(".popup__input_type_link-url");const k=new s(q,(function(e,t){return new r(e,t).create()})),C=new c(y),E=new c(g),L=new i(y),w=new i(g),x=new a(n,l),j=new o({baseUrl:"https://nomoreparties.co/cohort12",headers:{authorization:"fd6a5b73-7bb7-4dfa-8ed7-e499c84151ec","Content-type":"application/json"}}),P=new u(p,m,h,_,j);function A(){const e=document.querySelector(".popup__input_type_name"),t=document.querySelector(".popup__input_type_link-url");e.value="",t.value=""}function I(){document.querySelectorAll(".error").forEach((function(e){e.textContent=""}))}j.getInititalCards().then(e=>{k.render(e)}).catch(e=>{console.log(e)}),j.getProfile().then(e=>{P.setUserInfo(e.name,e.about),console.log(e.name)}).catch(e=>{console.log(e)}),q.addEventListener("click",(function(e){e.target.classList.contains("place-card__image")&&x.openWide(e.target.style.backgroundImage.slice(5,-2))})),b.addEventListener("click",()=>{C.close(),I(),A()}),S.addEventListener("click",()=>{E.close(),I(),A()}),v.addEventListener("click",()=>{E.open()}),f.addEventListener("click",(function(){C.open()})),L.setEventListeners(),t.addEventListener("submit",(function(e){e.preventDefault(),j.renewProfile(h.value,_.value).then(e=>{P.updateUserInfo(e.name,e.about)}).then(e=>{C.close(),I(),A()}).catch(e=>{console.log(e)})})),w.setEventListeners(),e.addEventListener("submit",(function(){event.preventDefault();const t=e.elements.name.value,n=e.elements.link.value;k.addCard(t,n),I(),A(),E.close()})),d.addEventListener("click",(function(e){n.classList.remove("popup_is-opened")}))}()}]);